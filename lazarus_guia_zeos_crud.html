<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD básico usando Zeos e FirebirdSQL - Gladiston Santana</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/estilo.css">
</head>
<body>

    <header class="main-header">
        <div class="header-container">
            <img src="assets/img/logo.jpg" alt="Logo" class="logo-circle">
            <div class="header-text">
                <h1>CRUD básico usando Zeos e FirebirdSQL</h1>
                <p>Gladiston Santana - Um site para chamar de meu</p>
            </div>
        </div>
    </header>

    <nav class="main-nav">
        <ul class="nav-links">
            <li><a href="index.html">Início</a></li>
            <li><a href="lazarus_guia.html">Guia de Sobrevivência</a></li>
        </ul>
    </nav>

    <main class="content-wrapper">
        <article>
            <h2>Introdução</h2>
            <p>CRUD é o básico do básico: <strong>C</strong>reate, <strong>R</strong>ead, <strong>U</strong>pdate e <strong>D</strong>elete. A maior parte dos programas “de gestão” do mundo é, no fundo, CRUD com regras de negócio em cima.</p>
            <p>Neste artigo eu mostro um CRUD enxuto usando <strong>Zeos</strong> (TZConnection/TZQuery) com <strong>FirebirdSQL</strong>, com exemplos prontos para você copiar e adaptar.</p>

            <h2>Recomendação de vídeos (na sequência)</h2>
            <p>Se você prefere acompanhar em vídeo, recomendo assistir nesta ordem:</p>

            <div class="video-cta">
                <p>Zeos CRUD – Parte 1</p>
                <a href="https://www.youtube.com/watch?v=0xnyUGqwCgU" target="_blank" rel="noopener" class="btn-play">ASSISTIR VÍDEO NO YOUTUBE</a>
            </div>

            <div class="video-cta">
                <p>Zeos CRUD – Parte 2</p>
                <a href="https://www.youtube.com/watch?v=orAGAc9KpQc" target="_blank" rel="noopener" class="btn-play">ASSISTIR VÍDEO NO YOUTUBE</a>
            </div>

            <div class="video-cta">
                <p>Zeos CRUD – Parte 3</p>
                <a href="https://www.youtube.com/watch?v=SHn4eILMAyo" target="_blank" rel="noopener" class="btn-play">ASSISTIR VÍDEO NO YOUTUBE</a>
            </div>

            <h2>Pré-requisitos</h2>
            <ul>
                <li><strong>Zeos instalado</strong> e disponível na paleta.</li>
                <li><strong>TZConnection configurado</strong> (driver Firebird e parâmetros corretos).</li>
                <li><strong>Uma tabela</strong> de exemplo para trabalhar.</li>
            </ul>

            <h2>Estrutura de tabela (exemplo Firebird)</h2>
            <p>Vamos usar uma tabela simples de clientes. Ajuste nomes e tipos conforme o seu caso:</p>

            <pre><code>create table clientes (
  id          bigint generated by default as identity primary key,
  nome        varchar(120) not null,
  email       varchar(150),
  dt_cadastro timestamp default current_timestamp
);</code></pre>

            <div class="info-box">
                <p><strong>Dica:</strong> Se você ainda não está usando <em>identity</em> (FB 3+), dá para usar SEQUENCE + TRIGGER, mas para um CRUD básico o identity simplifica bastante.</p>
            </div>

            <h2>Configuração mínima: TZConnection</h2>
            <p>Você pode configurar pelo Object Inspector, mas é útil saber o essencial (driver, database, user/pass). Um exemplo típico de parâmetros seria:</p>

            <pre><code>Protocol: firebird
HostName: 127.0.0.1
Port: 3050
Database: /caminho/do/banco.fdb
User: SYSDBA
Password: masterkey</code></pre>

            <h2>CRUD com TZQuery</h2>
            <p>A ideia é simples:</p>
            <ul>
                <li><strong>Read (listar)</strong>: usar <code>Open</code> (SELECT).</li>
                <li><strong>Create/Update/Delete</strong>: usar <code>ExecSQL</code> (INSERT/UPDATE/DELETE).</li>
                <li><strong>Parâmetros</strong>: sempre usar parâmetros (nada de concatenar strings).</li>
            </ul>

            <h3>Read: listar clientes</h3>
            <pre><code>// ZQueryList é um TZQuery ligado ao mesmo TZConnection
ZQueryList.Close;
ZQueryList.SQL.Text :=
  'select id, nome, email, dt_cadastro ' +
  'from clientes ' +
  'order by nome';
ZQueryList.Open;</code></pre>

            <h3>Create: inserir cliente (com RETURNING)</h3>
            <p>Em Firebird é comum usar <code>RETURNING</code> para obter o ID inserido sem precisar de select separado:</p>

            <pre><code>// Retorna o ID recém-criado em :p_id
ZQueryExec.Close;
ZQueryExec.SQL.Text :=
  'insert into clientes (nome, email) ' +
  'values (:p_nome, :p_email) ' +
  'returning id';
ZQueryExec.ParamByName('p_nome').AsString  := edtNome.Text;
ZQueryExec.ParamByName('p_email').AsString := edtEmail.Text;
ZQueryExec.Open; // RETURNING gera um resultset
ShowMessage('Novo ID: ' + ZQueryExec.Fields[0].AsString);</code></pre>

            <div class="warning-box">
                <p><strong>Importante:</strong> INSERT/UPDATE/DELETE normalmente usam <code>ExecSQL</code>. Porém, quando você usa <code>RETURNING</code>, você vai ter um resultset; por isso, neste caso, <code>Open</code> faz sentido.</p>
            </div>

            <h3>Update: atualizar cliente</h3>
            <pre><code>ZQueryExec.Close;
ZQueryExec.SQL.Text :=
  'update clientes set ' +
  '  nome = :p_nome, ' +
  '  email = :p_email ' +
  'where id = :p_id';
ZQueryExec.ParamByName('p_id').AsLargeInt := StrToInt64(edtId.Text);
ZQueryExec.ParamByName('p_nome').AsString := edtNome.Text;
ZQueryExec.ParamByName('p_email').AsString := edtEmail.Text;
ZQueryExec.ExecSQL;</code></pre>

            <h3>Delete: excluir cliente</h3>
            <pre><code>ZQueryExec.Close;
ZQueryExec.SQL.Text := 'delete from clientes where id = :p_id';
ZQueryExec.ParamByName('p_id').AsLargeInt := StrToInt64(edtId.Text);
ZQueryExec.ExecSQL;</code></pre>

            <h2>Transação: o que não pode faltar</h2>
            <p>Se você estiver fazendo mais de uma operação que precisa ser atômica (ex.: inserir “mestre” + “detalhe”, ou gravar e depois atualizar estoque), use transação explícita e garanta o fechamento.</p>

            <pre><code>// Padrão recomendado: se a transação iniciou, termina em Commit/Rollback
ZConnection1.StartTransaction;
try
  ZQueryExec.ExecSQL;
  ZQueryOutra.ExecSQL;
  ZConnection1.Commit;
except
  if ZConnection1.InTransaction then
    ZConnection1.Rollback;
  raise;
end;</code></pre>

            <h2>Conclusão</h2>
            <p>Esse é o “esqueleto” de um CRUD: query parametrizada, escolha correta entre <code>Open</code> e <code>ExecSQL</code>, e transação bem-fechada quando necessário. A partir daqui você acrescenta validações, regras de negócio, logs e testes.</p>

            <p style="margin-top: 3rem;"><a href="lazarus_guia.html" class="back-link">&larr; Voltar para o Guia de Sobrevivência</a></p>
        </article>
    </main>

    <footer class="main-footer">
        <p>&copy; 2026 Gladiston Santana - São Paulo, Brasil</p>
    </footer>

</body>
</html>

